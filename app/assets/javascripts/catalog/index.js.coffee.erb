$ ->
  set_dimensions()
  $(window).resize set_dimensions
  $('.history_item').history_item_form on_edit_opened: set_dimensions
  setup_testing_or_development()

setup_testing_or_development = ->
  $('.icon.edit').show() if AntCat.testing
  <%#else%>
    <%#if AntCat.environment is 'development'%>
      <%#$('.icon.edit').click()%>

set_dimensions = ->
  set_height()
  set_width()

set_height = ->
  if AntCat.HistoryItemForm.is_editing()
    $("#page").height('auto')
    $(".antcat_taxon").height('auto')
  else
    $("#page").height('100%')
    $(".antcat_taxon").height('20em')

  height = $('#page').height() -
    $('#site_header').height() -
    $('#page_header').height() - 2 -
    $('#page_notice').height() -
    $('#page_alert').height() -
    $('#search_results').height() - 3 - 2 - 2 -
    $('#taxon_key').height() - 2 -
    $('#site_footer').height() - 8

  if AntCat.HistoryItemForm.is_editing()
    $("#catalog").height('auto')
    $("#catalog .index").height('auto')
  else
    $("#catalog").height(height)
    $("#catalog .index").height(height - $("#catalog .content").height())

set_width = ->
  $("#catalog .content").width($('#page').width())
