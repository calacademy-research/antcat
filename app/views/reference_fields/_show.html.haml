-#Locals: references, current_reference

.template
  = render 'reference_fields/panel', reference: nil, publisher_string: ''

%table.references.current_reference
  %tr.reference_row
    %td
      - if current_reference
        = render 'reference_fields/panel', reference: current_reference, publisher_string: ''

= form_tag reference_field_path, class: 'search_form' do
  -# this table is to provide a fixed-width column for the throbber beside
  -# a variable width and height column for the controls
  %table
    %tr
      %td.throbber= image_tag 'ui-anim_basic_16x16.gif'
      %td.controls
        - if false
          .ok_cancel_controls
            = button_tag 'OK', class: 'ok ui-priority-primary'
            = button_tag 'Cancel', class: 'close ui-priority-secondary'

        .add_controls
          = button_tag 'Add', class: 'add ui-priority-primary'

        .search_controls
          = select_tag "search_selector", options_for_select(["Search for author(s)", "Search for"], params[:search_selector]), class: 'search_selector'
          = text_field_tag "q", params[:q], class: 'q'
          = button_tag 'Go', class: 'ui-priority-primary'
          - if false
            = button_tag 'Cancel', class: 'ui-priority-secondary close'

        = will_paginate references if references

        .help_banner
          %span.help_banner_text

- if references && (references.first != current_reference || references.size != 1 || params[:q].present?)

  -if references.empty?
    .no_results_found No results found

  %table.references.search_results
    - for reference in references
      %tr.reference_row
        %td= render 'reference_fields/panel', reference: reference, publisher_string: ''

= render 'shared/qtip'
