-#Locals: taxon, form

.epithet_status_flags_section.section
  %table.fields
    %tr
      = form.fields_for :name do |name_form|
        %td.label= name_form.label :epithet, 'Name'
        %td
          %span.parentage= Formatters::TaxonFormatter.new(@taxon).parentage_string
          %span.epithet= name_form.text_field :epithet, readonly: true

    %tr
      %td.label= form.label :status
      %td
        = form.select :status, Status.statuses

    %tr#homonym_replaced_by
      - form.object.homonym_replaced_by_name ||= form.object.homonym_replaced_by.try(:name)
      - form.object.homonym_replaced_by_name ||= Name.new
      = form.fields_for :homonym_replaced_by_name do |homonym_replaced_by_name_form|
        = hidden_field_tag 'taxon[homonym_replaced_by_name_attributes][id]', form.object.homonym_replaced_by_name.id
        %td.label= homonym_replaced_by_name_form.label :name, 'Replaced by'
        %td#homonym_replaced_by_name_field
          = render 'name_fields/panel', name_string: taxon.homonym_replaced_by_name.name, options: {allow_blank: true, disallow_add: true}

    %tr
      %td
      %td
        = form.label :incertae_sedis_in
        = form.select :incertae_sedis_in, [['(none)', nil], 'family', 'subfamily', 'tribe']

        = form.check_box :fossil
        = form.label :fossil

        = form.check_box :unidentifiable
        = form.label :unidentifiable

        = form.check_box :unresolved_homonym
        = form.label :unresolved_homonym, 'Unresolved junior homonym'

        = form.check_box :hong
        = form.label :hong

    %tr
      %td.label.top_aligned= form.label :headline_notes_taxt, 'Notes'
      %td#headline_notes_taxt_editor.taxt_editor
        = render 'taxt_editors/show', name: 'taxon[headline_notes_taxt]', value: Taxt.to_editable(@taxon.headline_notes_taxt)
